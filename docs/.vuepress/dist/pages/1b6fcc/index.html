<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>集成SpringSecurity | Friedy&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="个人知识库。">
    <meta name="keywords" content="个人知识库,web前端,后端开发,技术文档,面试题">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6a41b040.css" as="style"><link rel="preload" href="/assets/js/app.d0197ae6.js" as="script"><link rel="preload" href="/assets/js/2.ef8d47f0.js" as="script"><link rel="preload" href="/assets/js/94.c7f6d6b5.js" as="script"><link rel="prefetch" href="/assets/js/10.1d01ff10.js"><link rel="prefetch" href="/assets/js/100.2b9b5aae.js"><link rel="prefetch" href="/assets/js/101.75b863b9.js"><link rel="prefetch" href="/assets/js/102.9e7cf782.js"><link rel="prefetch" href="/assets/js/103.0fc1ceac.js"><link rel="prefetch" href="/assets/js/104.5826f530.js"><link rel="prefetch" href="/assets/js/105.6204fdb6.js"><link rel="prefetch" href="/assets/js/106.4e28cd8a.js"><link rel="prefetch" href="/assets/js/107.aa1e263b.js"><link rel="prefetch" href="/assets/js/108.5bd20b59.js"><link rel="prefetch" href="/assets/js/109.779c4ab1.js"><link rel="prefetch" href="/assets/js/11.e0b5c123.js"><link rel="prefetch" href="/assets/js/110.b6808604.js"><link rel="prefetch" href="/assets/js/111.f102bb68.js"><link rel="prefetch" href="/assets/js/112.d4927d0e.js"><link rel="prefetch" href="/assets/js/113.5a276c77.js"><link rel="prefetch" href="/assets/js/114.98ab8f3c.js"><link rel="prefetch" href="/assets/js/115.64a65253.js"><link rel="prefetch" href="/assets/js/116.05bbe242.js"><link rel="prefetch" href="/assets/js/117.76d0d18d.js"><link rel="prefetch" href="/assets/js/118.24e32aad.js"><link rel="prefetch" href="/assets/js/119.8ece5d11.js"><link rel="prefetch" href="/assets/js/12.0c46d315.js"><link rel="prefetch" href="/assets/js/120.5e4f23da.js"><link rel="prefetch" href="/assets/js/121.ba5efce4.js"><link rel="prefetch" href="/assets/js/122.828bd642.js"><link rel="prefetch" href="/assets/js/123.a3961485.js"><link rel="prefetch" href="/assets/js/124.1db2c860.js"><link rel="prefetch" href="/assets/js/125.177b6e8a.js"><link rel="prefetch" href="/assets/js/126.86be80fa.js"><link rel="prefetch" href="/assets/js/127.14af7a59.js"><link rel="prefetch" href="/assets/js/128.5e1d3e65.js"><link rel="prefetch" href="/assets/js/129.2dc0bec2.js"><link rel="prefetch" href="/assets/js/13.4eb23342.js"><link rel="prefetch" href="/assets/js/130.f46ebd36.js"><link rel="prefetch" href="/assets/js/131.8bd6d765.js"><link rel="prefetch" href="/assets/js/132.07a2ebfe.js"><link rel="prefetch" href="/assets/js/133.79680b78.js"><link rel="prefetch" href="/assets/js/134.01502e69.js"><link rel="prefetch" href="/assets/js/135.8ca9ecda.js"><link rel="prefetch" href="/assets/js/136.b95b3ca1.js"><link rel="prefetch" href="/assets/js/137.e7bf18ef.js"><link rel="prefetch" href="/assets/js/138.c9f6eae9.js"><link rel="prefetch" href="/assets/js/139.f30f5add.js"><link rel="prefetch" href="/assets/js/14.ace8b3fd.js"><link rel="prefetch" href="/assets/js/15.bf18e477.js"><link rel="prefetch" href="/assets/js/16.bbca9407.js"><link rel="prefetch" href="/assets/js/17.d7fcf007.js"><link rel="prefetch" href="/assets/js/18.6472da41.js"><link rel="prefetch" href="/assets/js/19.173aef51.js"><link rel="prefetch" href="/assets/js/20.3d568047.js"><link rel="prefetch" href="/assets/js/21.6784b417.js"><link rel="prefetch" href="/assets/js/22.2f9c95f8.js"><link rel="prefetch" href="/assets/js/23.e1712b3e.js"><link rel="prefetch" href="/assets/js/24.76c8eee5.js"><link rel="prefetch" href="/assets/js/25.3573ec01.js"><link rel="prefetch" href="/assets/js/26.19c074ad.js"><link rel="prefetch" href="/assets/js/27.41aaae9e.js"><link rel="prefetch" href="/assets/js/28.6ad2c766.js"><link rel="prefetch" href="/assets/js/29.18a9c51c.js"><link rel="prefetch" href="/assets/js/3.75662cb9.js"><link rel="prefetch" href="/assets/js/30.792281f6.js"><link rel="prefetch" href="/assets/js/31.041f16cf.js"><link rel="prefetch" href="/assets/js/32.047f948c.js"><link rel="prefetch" href="/assets/js/33.d6ffb2f2.js"><link rel="prefetch" href="/assets/js/34.b799b45f.js"><link rel="prefetch" href="/assets/js/35.9301ebf2.js"><link rel="prefetch" href="/assets/js/36.85cc9c31.js"><link rel="prefetch" href="/assets/js/37.7a38b7a6.js"><link rel="prefetch" href="/assets/js/38.4ba6f88c.js"><link rel="prefetch" href="/assets/js/39.35c8931d.js"><link rel="prefetch" href="/assets/js/4.b93b4620.js"><link rel="prefetch" href="/assets/js/40.880e96ff.js"><link rel="prefetch" href="/assets/js/41.54404c31.js"><link rel="prefetch" href="/assets/js/42.d368073f.js"><link rel="prefetch" href="/assets/js/43.a9331fc8.js"><link rel="prefetch" href="/assets/js/44.3e22636d.js"><link rel="prefetch" href="/assets/js/45.eadfe138.js"><link rel="prefetch" href="/assets/js/46.abe5fe7d.js"><link rel="prefetch" href="/assets/js/47.2ae1aa04.js"><link rel="prefetch" href="/assets/js/48.0d947e10.js"><link rel="prefetch" href="/assets/js/49.817c3ce8.js"><link rel="prefetch" href="/assets/js/5.3aeef52e.js"><link rel="prefetch" href="/assets/js/50.f5ba62eb.js"><link rel="prefetch" href="/assets/js/51.0654fb38.js"><link rel="prefetch" href="/assets/js/52.a53421f5.js"><link rel="prefetch" href="/assets/js/53.5a980fa4.js"><link rel="prefetch" href="/assets/js/54.9dd821e3.js"><link rel="prefetch" href="/assets/js/55.d4fbe964.js"><link rel="prefetch" href="/assets/js/56.7ae6e991.js"><link rel="prefetch" href="/assets/js/57.d482e264.js"><link rel="prefetch" href="/assets/js/58.91f6909c.js"><link rel="prefetch" href="/assets/js/59.e691e0fd.js"><link rel="prefetch" href="/assets/js/6.d441480a.js"><link rel="prefetch" href="/assets/js/60.24cc0c90.js"><link rel="prefetch" href="/assets/js/61.8f8ca26e.js"><link rel="prefetch" href="/assets/js/62.340af0c2.js"><link rel="prefetch" href="/assets/js/63.8dfb16f1.js"><link rel="prefetch" href="/assets/js/64.57e783ee.js"><link rel="prefetch" href="/assets/js/65.14182562.js"><link rel="prefetch" href="/assets/js/66.423befb6.js"><link rel="prefetch" href="/assets/js/67.abf583ed.js"><link rel="prefetch" href="/assets/js/68.6251952b.js"><link rel="prefetch" href="/assets/js/69.3b8e5d29.js"><link rel="prefetch" href="/assets/js/7.8d329acc.js"><link rel="prefetch" href="/assets/js/70.b86d6d46.js"><link rel="prefetch" href="/assets/js/71.3f1d65bc.js"><link rel="prefetch" href="/assets/js/72.5783a4b9.js"><link rel="prefetch" href="/assets/js/73.bb79ee05.js"><link rel="prefetch" href="/assets/js/74.3f037891.js"><link rel="prefetch" href="/assets/js/75.dd700b75.js"><link rel="prefetch" href="/assets/js/76.07c0373f.js"><link rel="prefetch" href="/assets/js/77.cd9b1e7a.js"><link rel="prefetch" href="/assets/js/78.b05ab88d.js"><link rel="prefetch" href="/assets/js/79.5a7b3936.js"><link rel="prefetch" href="/assets/js/8.dbfd0b4a.js"><link rel="prefetch" href="/assets/js/80.76121f6c.js"><link rel="prefetch" href="/assets/js/81.2e778d60.js"><link rel="prefetch" href="/assets/js/82.559e7a59.js"><link rel="prefetch" href="/assets/js/83.7e4db373.js"><link rel="prefetch" href="/assets/js/84.62c82329.js"><link rel="prefetch" href="/assets/js/85.3130a40f.js"><link rel="prefetch" href="/assets/js/86.dd2a8e91.js"><link rel="prefetch" href="/assets/js/87.df07c27a.js"><link rel="prefetch" href="/assets/js/88.89cd374e.js"><link rel="prefetch" href="/assets/js/89.53dd8dd4.js"><link rel="prefetch" href="/assets/js/9.37f9f1d3.js"><link rel="prefetch" href="/assets/js/90.35a1295e.js"><link rel="prefetch" href="/assets/js/91.7ff95509.js"><link rel="prefetch" href="/assets/js/92.3b08b620.js"><link rel="prefetch" href="/assets/js/93.68d75394.js"><link rel="prefetch" href="/assets/js/95.84ae6971.js"><link rel="prefetch" href="/assets/js/96.39bf951f.js"><link rel="prefetch" href="/assets/js/97.76417f5c.js"><link rel="prefetch" href="/assets/js/98.fb58502c.js"><link rel="prefetch" href="/assets/js/99.019f6062.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6a41b040.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Friedy's blog" class="logo"> <span class="site-name can-hide">Friedy's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/wxmini/" class="nav-link">小程序笔记</a></li><li class="dropdown-item"><!----> <a href="/web/css/" class="nav-link">《CSS》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/html/" class="nav-link">《HTML》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/back/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back/java/" class="nav-link">《Java》笔记</a></li><li class="dropdown-item"><!----> <a href="/back/springboot/" class="nav-link">《SpringBoot》笔记</a></li><li class="dropdown-item"><!----> <a href="/back/springcloud/" class="nav-link">《SpringCloud》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/tec/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tec/git/" class="nav-link">《Git》笔记</a></li><li class="dropdown-item"><!----> <a href="/tec/github/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/tec/tecdocs/" class="nav-link">技术文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/friedy37/friedy37.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://jsd.cdn.zzko.cn/gh/friedy37/picgo/127.jpeg"> <div class="blogger-info"><h3>Friedy</h3> <span>全栈攻城狮</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/wxmini/" class="nav-link">小程序笔记</a></li><li class="dropdown-item"><!----> <a href="/web/css/" class="nav-link">《CSS》笔记</a></li><li class="dropdown-item"><!----> <a href="/web/html/" class="nav-link">《HTML》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/back/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back/java/" class="nav-link">《Java》笔记</a></li><li class="dropdown-item"><!----> <a href="/back/springboot/" class="nav-link">《SpringBoot》笔记</a></li><li class="dropdown-item"><!----> <a href="/back/springcloud/" class="nav-link">《SpringCloud》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/tec/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tec/git/" class="nav-link">《Git》笔记</a></li><li class="dropdown-item"><!----> <a href="/tec/github/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/tec/tecdocs/" class="nav-link">技术文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/friedy37/friedy37.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技巧</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>整合</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f0dd7b/" class="sidebar-link">SpringBoot整合JDBC</a></li><li><a href="/pages/57dcc8/" class="sidebar-link">SpringBoot整合Druid</a></li><li><a href="/pages/dd7004/" class="sidebar-link">SpringBoot整合mybatis</a></li><li><a href="/pages/703654/" class="sidebar-link">Web开发静态资源处理</a></li><li><a href="/pages/82c7ef/" class="sidebar-link">Thymeleaf模版引擎</a></li><li><a href="/pages/92749c/" class="sidebar-link">MVC自动配置原理</a></li><li><a href="/pages/9242e6/" class="sidebar-link">集成Swagger</a></li><li><a href="/pages/60b44f/" class="sidebar-link">Dubbo和Zookeeper集成</a></li><li><a href="/pages/1b6fcc/" aria-current="page" class="active sidebar-link">集成SpringSecurity</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/1b6fcc/#p18、集成-springsecurity" class="sidebar-link">P18、集成 SpringSecurity</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/1b6fcc/#_18-1、安全简介" class="sidebar-link">18.1、安全简介</a></li><li class="sidebar-sub-header level3"><a href="/pages/1b6fcc/#_18-2、实战测试" class="sidebar-link">18.2、实战测试</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-1、实验环境搭建" class="sidebar-link">18.2.1、实验环境搭建</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-2、认识-springsecurity" class="sidebar-link">18.2.2、认识 SpringSecurity</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-3、认证和授权" class="sidebar-link">18.2.3、认证和授权</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-4、权限控制和注销" class="sidebar-link">18.2.4、权限控制和注销</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-5、记住我" class="sidebar-link">18.2.5、记住我</a></li><li class="sidebar-sub-header level4"><a href="/pages/1b6fcc/#_18-2-6、定制登录页" class="sidebar-link">18.2.6、定制登录页</a></li><li class="sidebar-sub-header level3"><a href="/pages/1b6fcc/#_18-3、完整配置代码" class="sidebar-link">18.3、完整配置代码</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/back/springboot/#《SpringBoot》笔记" data-v-06225672>《SpringBoot》笔记</a></li><li data-v-06225672><a href="/back/springboot/#整合" data-v-06225672>整合</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/friedy37" target="_blank" title="作者" class="beLink" data-v-06225672>friedy37</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-06-08</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">集成SpringSecurity<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="p18、集成-springsecurity"><a href="#p18、集成-springsecurity" class="header-anchor">#</a> P18、集成 SpringSecurity</h2> <h3 id="_18-1、安全简介"><a href="#_18-1、安全简介" class="header-anchor">#</a> 18.1、安全简介</h3> <p>在 Web 开发中，安全一直是非常重要的一个方面。安全虽然属于应用的非功能性需求，但是应该在应用开发的初期就考虑进来。如果在应用开发的后期才考虑安全的问题，就可能陷入一个两难的境地：一方面，应用存在严重的安全漏洞，无法满足用户的要求，并可能造成用户的隐私数据被攻击者窃取；另一方面，应用的基本架构已经确定，要修复安全漏洞，可能需要对系统的架构做出比较重大的调整，因而需要更多的开发时间，影响应用的发布进程。因此，从应用开发的第一天就应该把安全相关的因素考虑进来，并在整个应用的开发过程中。</p> <p>市面上存在比较有名的：Shiro，Spring Security ！</p> <p>这里需要阐述一下的是，每一个框架的出现都是为了解决某一问题而产生了，那么 Spring Security 框架的出现是为了解决什么问题呢？</p> <p>首先我们看下它的官网介绍：Spring Security 官网地址</p> <p>Spring Security is a powerful and highly customizable authentication and access-control framework. It is the de-facto standard for securing Spring-based applications.</p> <p>Spring Security is a framework that focuses on providing both authentication and authorization to Java applications. Like all Spring projects, the real power of Spring Security is found in how easily it can be extended to meet custom requirements</p> <p>Spring Security 是一个功能强大且高度可定制的身份验证和访问控制框架。它实际上是保护基于 spring 的应用程序的标准。</p> <p>Spring Security 是一个框架，侧重于为 Java 应用程序提供身份验证和授权。与所有 Spring 项目一样，Spring 安全性的真正强大之处在于它可以轻松地扩展以满足定制需求</p> <p>从官网的介绍中可以知道这是一个权限框架。想我们之前做项目是没有使用框架是怎么控制权限的？对于权限 一般会细分为功能权限，访问权限，和菜单权限。代码会写的非常的繁琐，冗余。</p> <p>怎么解决之前写权限代码繁琐，冗余的问题，一些主流框架就应运而生而 Spring Scecurity 就是其中的一种。</p> <p>Spring 是一个非常流行和成功的 Java 应用开发框架。Spring Security 基于 Spring 框架，提供了一套 Web 应用安全性的完整解决方案。一般来说，Web 应用的安全性包括用户认证（Authentication）和用户授权（Authorization）两个部分。用户认证指的是验证某个用户是否为系统中的合法主体，也就是说用户能否访问该系统。用户认证一般要求用户提供用户名和密码。系统通过校验用户名和密码来完成认证过程。用户授权指的是验证某个用户是否有权限执行某个操作。在一个系统中，不同用户所具有的权限是不同的。比如对一个文件来说，有的用户只能进行读取，而有的用户可以进行修改。一般来说，系统会为不同的用户分配不同的角色，而每个角色则对应一系列的权限。</p> <p>对于上面提到的两种应用情景，Spring Security 框架都有很好的支持。在用户认证方面，Spring Security 框架支持主流的认证方式，包括 HTTP 基本认证、HTTP 表单验证、HTTP 摘要认证、OpenID 和 LDAP 等。在用户授权方面，Spring Security 提供了基于角色的访问控制和访问控制列表（Access Control List，ACL），可以对应用中的领域对象进行细粒度的控制。</p> <h3 id="_18-2、实战测试"><a href="#_18-2、实战测试" class="header-anchor">#</a> 18.2、实战测试</h3> <h4 id="_18-2-1、实验环境搭建"><a href="#_18-2-1、实验环境搭建" class="header-anchor">#</a> 18.2.1、实验环境搭建</h4> <p>1、新建一个初始的 springboot 项目 web 模块，thymeleaf 模块</p> <p>2、导入静态资源</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>welcome.html
|views
|level1
1.html
2.html
3.html
|level2
1.html
2.html
3.html
|level3
1.html
2.html
3.html
Login.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>3、controller 跳转！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.kuang.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class RouterController {

   @RequestMapping({&quot;/&quot;,&quot;/index&quot;})
   public String index(){
       return &quot;index&quot;;
  }

   @RequestMapping(&quot;/toLogin&quot;)
   public String toLogin(){
       return &quot;views/login&quot;;
  }

   @RequestMapping(&quot;/level1/{id}&quot;)
   public String level1(@PathVariable(&quot;id&quot;) int id){
       return &quot;views/level1/&quot;+id;
  }

   @RequestMapping(&quot;/level2/{id}&quot;)
   public String level2(@PathVariable(&quot;id&quot;) int id){
       return &quot;views/level2/&quot;+id;
  }

   @RequestMapping(&quot;/level3/{id}&quot;)
   public String level3(@PathVariable(&quot;id&quot;) int id){
       return &quot;views/level3/&quot;+id;
  }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>4、测试实验环境是否 OK！</p> <h4 id="_18-2-2、认识-springsecurity"><a href="#_18-2-2、认识-springsecurity" class="header-anchor">#</a> 18.2.2、认识 SpringSecurity</h4> <p>Spring Security 是针对 Spring 项目的安全框架，也是 Spring Boot 底层安全模块默认的技术选型，他可以实现强大的 Web 安全控制，对于安全控制，我们仅需要引入 spring-boot-starter-security 模块，进行少量的配置，即可实现强大的安全管理！</p> <p>记住几个类：</p> <ul><li>WebSecurityConfigurerAdapter：自定义 Security 策略</li> <li>AuthenticationManagerBuilder：自定义认证策略</li> <li>@EnableWebSecurity：开启 WebSecurity 模式</li></ul> <p>Spring Security 的两个主要目标是 “认证” 和 “授权”（访问控制）。</p> <p><strong>“认证”（Authentication）</strong></p> <p>身份验证是关于验证您的凭据，如用户名 / 用户 ID 和密码，以验证您的身份。</p> <p>身份验证通常通过用户名和密码完成，有时与身份验证因素结合使用。</p> <p><strong>“授权” （Authorization）</strong></p> <p>授权发生在系统成功验证您的身份后，最终会授予您访问资源（如信息，文件，数据库，资金，位置，几乎任何内容）的完全权限。</p> <p>这个概念是通用的，而不是只在 Spring Security 中存在。</p> <h4 id="_18-2-3、认证和授权"><a href="#_18-2-3、认证和授权" class="header-anchor">#</a> 18.2.3、认证和授权</h4> <p>目前，我们的测试环境，是谁都可以访问的，我们使用 Spring Security 增加上认证和授权的功能</p> <p>1、引入 Spring Security 模块</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2、编写 Spring Security 配置类</p> <p>参考官网：https://spring.io/projects/spring-security</p> <p>查看我们自己项目中的版本，找到对应的帮助文档：</p> <p>https://docs.spring.io/spring-security/site/docs/5.3.0.RELEASE/reference/html5 #servlet-applications 8.16.4</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/408a48afe020e5de4eed7b79d01c5970.png" alt=""></p> <p>3、编写基础配置类</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.kuang.config;

import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@EnableWebSecurity // 开启WebSecurity模式
public class SecurityConfig extends WebSecurityConfigurerAdapter {

   @Override
   protected void configure(HttpSecurity http) throws Exception {
       
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>4、定制请求的授权规则</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Override
protected void configure(HttpSecurity http) throws Exception {
   // 定制请求的授权规则
   // 首页所有人可以访问
   http.authorizeRequests().antMatchers(&quot;/&quot;).permitAll()
  .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;vip1&quot;)
  .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;vip2&quot;)
  .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;vip3&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>5、测试一下：发现除了首页都进不去了！因为我们目前没有登录的角色，因为请求需要登录的角色拥有对应的权限才可以！</p> <p>6、在 configure() 方法中加入以下配置，开启自动配置的登录功能！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 开启自动配置的登录功能
// /login 请求来到登录页
// /login?error 重定向到这里表示登录失败
http.formLogin();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>7、测试一下：发现，没有权限的时候，会跳转到登录的页面！</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/eaf88d568106ce6b46869427a35de839.png" alt=""></p> <p>8、查看刚才登录页的注释信息；</p> <p>我们可以定义认证规则，重写 configure(AuthenticationManagerBuilder auth) 方法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//定义认证规则
@Override
protected void configure(AuthenticationManagerBuilder auth) throws Exception {
   
   //在内存中定义，也可以在jdbc中去拿....
   auth.inMemoryAuthentication()
          .withUser(&quot;kuangshen&quot;).password(&quot;123456&quot;).roles(&quot;vip2&quot;,&quot;vip3&quot;)
          .and()
          .withUser(&quot;root&quot;).password(&quot;123456&quot;).roles(&quot;vip1&quot;,&quot;vip2&quot;,&quot;vip3&quot;)
          .and()
          .withUser(&quot;guest&quot;).password(&quot;123456&quot;).roles(&quot;vip1&quot;,&quot;vip2&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>9、测试，我们可以使用这些账号登录进行测试！发现会报错！</p> <p>There is no PasswordEncoder mapped for the id “null”</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/370af0af88d94173b6ed5bc6d62ca70f.png" alt=""></p> <p>10、原因，我们要将前端传过来的密码进行某种方式加密，否则就无法登录，修改代码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//定义认证规则
@Override
protected void configure(AuthenticationManagerBuilder auth) throws Exception {
   //在内存中定义，也可以在jdbc中去拿....
   //Spring security 5.0中新增了多种加密方式，也改变了密码的格式。
   //要想我们的项目还能够正常登陆，需要修改一下configure中的代码。我们要将前端传过来的密码进行某种方式加密
   //spring security 官方推荐的是使用bcrypt加密方式。
   
   auth.inMemoryAuthentication().passwordEncoder(new BCryptPasswordEncoder())
          .withUser(&quot;kuangshen&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip2&quot;,&quot;vip3&quot;)
          .and()
          .withUser(&quot;root&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip1&quot;,&quot;vip2&quot;,&quot;vip3&quot;)
          .and()
          .withUser(&quot;guest&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip1&quot;,&quot;vip2&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>11、测试，发现，登录成功，并且每个角色只能访问自己认证下的规则！搞定</p> <h4 id="_18-2-4、权限控制和注销"><a href="#_18-2-4、权限控制和注销" class="header-anchor">#</a> 18.2.4、权限控制和注销</h4> <p>1、开启自动配置的注销的功能</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//定制请求的授权规则
@Override
protected void configure(HttpSecurity http) throws Exception {
   //....
   //开启自动配置的注销的功能
      // /logout 注销请求
   http.logout();
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>2、我们在前端，增加一个注销的按钮，index.html 导航栏中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;a class=&quot;item&quot; th:href=&quot;@{/logout}&quot;&gt;
   &lt;i class=&quot;address card icon&quot;&gt;&lt;/i&gt; 注销
&lt;/a&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3、我们可以去测试一下，登录成功后点击注销，发现注销完毕会跳转到登录页面！</p> <p>4、但是，我们想让他注销成功后，依旧可以跳转到首页，该怎么处理呢？</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// .logoutSuccessUrl(&quot;/&quot;); 注销成功来到首页
http.logout().logoutSuccessUrl(&quot;/&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>5、测试，注销完毕后，发现跳转到首页 OK</p> <p>6、我们现在又来一个需求：用户没有登录的时候，导航栏上只显示登录按钮，用户登录之后，导航栏可以显示登录的用户信息及注销按钮！还有就是，比如 kuangshen 这个用户，它只有 vip2，vip3 功能，那么登录则只显示这两个功能，而 vip1 的功能菜单不显示！这个就是真实的网站情况了！该如何做呢？</p> <p><strong>我们需要结合 thymeleaf 中的一些功能</strong></p> <p>sec：authorize=“isAuthenticated()”: 是否认证登录！来显示不同的页面</p> <p>Maven 依赖：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-springsecurity4 --&gt;
&lt;dependency&gt;
   &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;
   &lt;artifactId&gt;thymeleaf-extras-springsecurity5&lt;/artifactId&gt;
   &lt;version&gt;3.0.4.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>7、修改我们的 前端页面</p> <ol><li><p>导入命名空间</p></li> <li><div class="language- line-numbers-mode"><pre class="language-text"><code>xmlns:sec=&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改导航栏，增加认证判断</p></li> <li><div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!--登录注销--&gt;
&lt;div class=&quot;right menu&quot;&gt;

   &lt;!--如果未登录--&gt;
   &lt;div sec:authorize=&quot;!isAuthenticated()&quot;&gt;
       &lt;a class=&quot;item&quot; th:href=&quot;@{/login}&quot;&gt;
           &lt;i class=&quot;address card icon&quot;&gt;&lt;/i&gt; 登录
       &lt;/a&gt;
   &lt;/div&gt;

   &lt;!--如果已登录--&gt;
   &lt;div sec:authorize=&quot;isAuthenticated()&quot;&gt;
       &lt;a class=&quot;item&quot;&gt;
           &lt;i class=&quot;address card icon&quot;&gt;&lt;/i&gt;
          用户名：&lt;span sec:authentication=&quot;principal.username&quot;&gt;&lt;/span&gt;
          角色：&lt;span sec:authentication=&quot;principal.authorities&quot;&gt;&lt;/span&gt;
       &lt;/a&gt;
   &lt;/div&gt;

   &lt;div sec:authorize=&quot;isAuthenticated()&quot;&gt;
       &lt;a class=&quot;item&quot; th:href=&quot;@{/logout}&quot;&gt;
           &lt;i class=&quot;address card icon&quot;&gt;&lt;/i&gt; 注销
       &lt;/a&gt;
   &lt;/div&gt;
&lt;/div&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></li></ol> <p>8、重启测试，我们可以登录试试看，登录成功后确实，显示了我们想要的页面；</p> <p>9、如果注销 404 了，就是因为它默认防止 csrf 跨站请求伪造，因为会产生安全问题，我们可以将请求改为 post 表单提交，或者在 spring security 中关闭 csrf 功能；我们试试：在 配置中增加 <code>http.csrf().disable();</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http.csrf().disable();//关闭csrf功能:跨站请求伪造,默认只能通过post方式提交logout请求
http.logout().logoutSuccessUrl(&quot;/&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>10、我们继续将下面的角色功能块认证完成！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- sec:authorize=&quot;hasRole('vip1')&quot; --&gt;
&lt;div class=&quot;column&quot; sec:authorize=&quot;hasRole('vip1')&quot;&gt;
   &lt;div class=&quot;ui raised segment&quot;&gt;
       &lt;div class=&quot;ui&quot;&gt;
           &lt;div class=&quot;content&quot;&gt;
               &lt;h5 class=&quot;content&quot;&gt;Level 1&lt;/h5&gt;
               &lt;hr&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level1/1}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-1-1&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level1/2}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-1-2&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level1/3}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-1-3&lt;/a&gt;&lt;/div&gt;
           &lt;/div&gt;
       &lt;/div&gt;
   &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;column&quot; sec:authorize=&quot;hasRole('vip2')&quot;&gt;
   &lt;div class=&quot;ui raised segment&quot;&gt;
       &lt;div class=&quot;ui&quot;&gt;
           &lt;div class=&quot;content&quot;&gt;
               &lt;h5 class=&quot;content&quot;&gt;Level 2&lt;/h5&gt;
               &lt;hr&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level2/1}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-2-1&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level2/2}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-2-2&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level2/3}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-2-3&lt;/a&gt;&lt;/div&gt;
           &lt;/div&gt;
       &lt;/div&gt;
   &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;column&quot; sec:authorize=&quot;hasRole('vip3')&quot;&gt;
   &lt;div class=&quot;ui raised segment&quot;&gt;
       &lt;div class=&quot;ui&quot;&gt;
           &lt;div class=&quot;content&quot;&gt;
               &lt;h5 class=&quot;content&quot;&gt;Level 3&lt;/h5&gt;
               &lt;hr&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level3/1}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-3-1&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level3/2}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-3-2&lt;/a&gt;&lt;/div&gt;
               &lt;div&gt;&lt;a th:href=&quot;@{/level3/3}&quot;&gt;&lt;i class=&quot;bullhorn icon&quot;&gt;&lt;/i&gt; Level-3-3&lt;/a&gt;&lt;/div&gt;
           &lt;/div&gt;
       &lt;/div&gt;
   &lt;/div&gt;
&lt;/div&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>11、测试一下！</p> <p>12、权限控制和注销搞定！</p> <h4 id="_18-2-5、记住我"><a href="#_18-2-5、记住我" class="header-anchor">#</a> 18.2.5、记住我</h4> <p>现在的情况，我们只要登录之后，关闭浏览器，再登录，就会让我们重新登录，但是很多网站的情况，就是有一个记住密码的功能，这个该如何实现呢？很简单</p> <p>1、开启记住我功能</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//定制请求的授权规则
@Override
protected void configure(HttpSecurity http) throws Exception {
//。。。。。。。。。。。
   //记住我
   http.rememberMe();
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2、我们再次启动项目测试一下，发现登录页多了一个记住我功能，我们登录之后关闭 浏览器，然后重新打开浏览器访问，发现用户依旧存在！</p> <p>思考：如何实现的呢？其实非常简单</p> <p>我们可以查看浏览器的 cookie</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/e9b5578efb77d9ec466eeca9613882ed.png" alt=""></p> <p>3、我们点击注销的时候，可以发现，spring security 帮我们自动删除了这个 cookie</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/8bc4b63bae73a0bebe9b70a632b0cc6f.png" alt=""><br>
4、结论：登录成功后，将 cookie 发送给浏览器保存，以后登录带上这个 cookie，只要通过检查就可以免登录了。如果点击注销，则会删除这个 cookie，具体的原理我们在 JavaWeb 阶段都讲过了，这里就不在多说了！</p> <h4 id="_18-2-6、定制登录页"><a href="#_18-2-6、定制登录页" class="header-anchor">#</a> 18.2.6、定制登录页</h4> <p>现在这个登录页面都是 spring security 默认的，怎么样可以使用我们自己写的 Login 界面呢？</p> <p>1、在刚才的登录页配置后面指定 loginpage</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http.formLogin().loginPage(&quot;/toLogin&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、然后前端也需要指向我们自己定义的 login 请求</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;a class=&quot;item&quot; th:href=&quot;@{/toLogin}&quot;&gt;
   &lt;i class=&quot;address card icon&quot;&gt;&lt;/i&gt; 登录
&lt;/a&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3、我们登录，需要将这些信息发送到哪里，我们也需要配置，login.html 配置提交请求及方式，方式必须为 post:</p> <p>在 loginPage() 源码中的注释上有写明：</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/3f0a7ac45b3ef4ef40bb2725f17b38bf.png" alt=""></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;form th:action=&quot;@{/login}&quot; method=&quot;post&quot;&gt;
   &lt;div class=&quot;field&quot;&gt;
       &lt;label&gt;Username&lt;/label&gt;
       &lt;div class=&quot;ui left icon input&quot;&gt;
           &lt;input type=&quot;text&quot; placeholder=&quot;Username&quot; &gt;
           &lt;i class=&quot;user icon&quot;&gt;&lt;/i&gt;
       &lt;/div&gt;
   &lt;/div&gt;
   &lt;div class=&quot;field&quot;&gt;
       &lt;label&gt;Password&lt;/label&gt;
       &lt;div class=&quot;ui left icon input&quot;&gt;
           &lt;input type=&quot;password&quot; &gt;
           &lt;i class=&quot;lock icon&quot;&gt;&lt;/i&gt;
       &lt;/div&gt;
   &lt;/div&gt;
   &lt;input type=&quot;submit&quot; class=&quot;ui blue submit button&quot;/&gt;
&lt;/form&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>4、这个请求提交上来，我们还需要验证处理，怎么做呢？我们可以查看 formLogin() 方法的源码！我们配置接收登录的用户名和密码的参数！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http.formLogin()
  .usernameParameter(&quot;username&quot;)
  .passwordParameter(&quot;password&quot;)
  .loginPage(&quot;/toLogin&quot;)
  .loginProcessingUrl(&quot;/login&quot;); // 登陆表单提交请求
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>5、在登录页增加记住我的多选框</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;input type=&quot;checkbox&quot; &gt; 记住我
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>6、后端验证处理！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//定制记住我的参数！
http.rememberMe().rememberMeParameter(&quot;remember&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>7、测试，OK</p> <h3 id="_18-3、完整配置代码"><a href="#_18-3、完整配置代码" class="header-anchor">#</a> 18.3、完整配置代码</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.kuang.config;

import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

   //定制请求的授权规则
   @Override
   protected void configure(HttpSecurity http) throws Exception {

       http.authorizeRequests().antMatchers(&quot;/&quot;).permitAll()
      .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;vip1&quot;)
      .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;vip2&quot;)
      .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;vip3&quot;);


       //开启自动配置的登录功能：如果没有权限，就会跳转到登录页面！
           // /login 请求来到登录页
           // /login?error 重定向到这里表示登录失败
       http.formLogin()
          .usernameParameter(&quot;username&quot;)
          .passwordParameter(&quot;password&quot;)
          .loginPage(&quot;/toLogin&quot;)
          .loginProcessingUrl(&quot;/login&quot;); // 登陆表单提交请求

       //开启自动配置的注销的功能
           // /logout 注销请求
           // .logoutSuccessUrl(&quot;/&quot;); 注销成功来到首页

       http.csrf().disable();//关闭csrf功能:跨站请求伪造,默认只能通过post方式提交logout请求
       http.logout().logoutSuccessUrl(&quot;/&quot;);

       //记住我
       http.rememberMe().rememberMeParameter(&quot;remember&quot;);
  }

   //定义认证规则
   @Override
   protected void configure(AuthenticationManagerBuilder auth) throws Exception {
       //在内存中定义，也可以在jdbc中去拿....
       //Spring security 5.0中新增了多种加密方式，也改变了密码的格式。
       //要想我们的项目还能够正常登陆，需要修改一下configure中的代码。我们要将前端传过来的密码进行某种方式加密
       //spring security 官方推荐的是使用bcrypt加密方式。

       auth.inMemoryAuthentication().passwordEncoder(new BCryptPasswordEncoder())
              .withUser(&quot;kuangshen&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip2&quot;,&quot;vip3&quot;)
              .and()
              .withUser(&quot;root&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip1&quot;,&quot;vip2&quot;,&quot;vip3&quot;)
              .and()
              .withUser(&quot;guest&quot;).password(new BCryptPasswordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip1&quot;,&quot;vip2&quot;);
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/friedy37/friedy37.github.io/edit/master/docs/《SpringBoot》笔记/03.整合/18.集成SpringSecurity.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=SpringBoot" title="标签">#SpringBoot</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/60b44f/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Dubbo和Zookeeper集成</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/60b44f/" class="prev">Dubbo和Zookeeper集成</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/d68089/"><div>
            技巧
            <!----></div></a> <span class="date">06-09</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f21f48/"><div>
            基础
            <!----></div></a> <span class="date">06-09</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/32fd80/"><div>
            进阶
            <!----></div></a> <span class="date">06-09</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:276970215@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/friedy37" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>Evan Xu | <a href="https://github.com/friedy37/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.d0197ae6.js" defer></script><script src="/assets/js/2.ef8d47f0.js" defer></script><script src="/assets/js/94.c7f6d6b5.js" defer></script>
  </body>
</html>
